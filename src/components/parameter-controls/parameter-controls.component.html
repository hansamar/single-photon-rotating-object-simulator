
<div class="bg-gray-900 p-6 rounded-lg shadow-lg border border-gray-700">
  <h2 class="text-2xl font-semibold mb-4 text-white border-b border-gray-700 pb-2">2. Set Parameters</h2>
  <div class="space-y-6">
    <!-- RPM -->
    <div>
      <label for="rpm" class="block text-sm font-medium text-gray-300">RPM (Revolutions Per Minute)</label>
      <div class="flex items-center gap-4 mt-1">
        <input type="range" id="rpm" min="100" max="10000" step="100" [value]="params().rpm" (input)="updateParam('rpm', $any($event.target).valueAsNumber)" [disabled]="isDisabled()"
               class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-cyan-500">
        <input type="number" [value]="params().rpm" (input)="updateParam('rpm', $any($event.target).valueAsNumber)" [disabled]="isDisabled()"
               class="w-24 bg-gray-800 border border-gray-600 rounded-md p-2 text-center">
      </div>
    </div>

    <!-- Distance -->
    <div>
      <label for="distance" class="block text-sm font-medium text-gray-300">Distance (m)</label>
      <div class="flex items-center gap-4 mt-1">
        <input type="range" id="distance" min="1" max="20" step="0.1" [value]="params().distance" (input)="updateParam('distance', $any($event.target).valueAsNumber)" [disabled]="isDisabled()"
               class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-cyan-500">
        <input type="number" [value]="params().distance" (input)="updateParam('distance', $any($event.target).valueAsNumber)" [disabled]="isDisabled()"
               class="w-24 bg-gray-800 border border-gray-600 rounded-md p-2 text-center">
      </div>
    </div>

    <!-- Number of Frames -->
    <div>
      <label for="nFrames" class="block text-sm font-medium text-gray-300">Number of Frames</label>
      <div class="flex items-center gap-4 mt-1">
        <input type="range" id="nFrames" min="1000" max="200000" step="1000" [value]="params().nFrames" (input)="updateParam('nFrames', $any($event.target).valueAsNumber)" [disabled]="isDisabled()"
               class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-cyan-500">
        <input type="number" [value]="params().nFrames" (input)="updateParam('nFrames', $any($event.target).valueAsNumber)" [disabled]="isDisabled()"
               class="w-24 bg-gray-800 border border-gray-600 rounded-md p-2 text-center">
      </div>
    </div>
    
    <!-- Resolution -->
    <div>
       <label for="resolution" class="block text-sm font-medium text-gray-300">Sensor Resolution</label>
       <select id="resolution" [ngModel]="resolutionString()" (ngModelChange)="updateResolution($event)" [disabled]="isDisabled()"
               class="mt-1 block w-full bg-gray-800 border border-gray-600 rounded-md p-2 focus:ring-cyan-500 focus:border-cyan-500">
          <option value="64">64x64</option>
          <option value="128">128x128</option>
          <option value="256">256x256</option>
       </select>
    </div>

    <!-- Camera FOV -->
    <div>
      <label for="fov" class="block text-sm font-medium text-gray-300">Camera FOV (degrees)</label>
      <div class="flex items-center gap-4 mt-1">
        <input type="range" id="fov" min="5" max="90" step="1" [value]="params().fov" (input)="updateParam('fov', $any($event.target).valueAsNumber)" [disabled]="isDisabled()"
               class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-cyan-500">
        <input type="number" [value]="params().fov" (input)="updateParam('fov', $any($event.target).valueAsNumber)" [disabled]="isDisabled()"
               class="w-24 bg-gray-800 border border-gray-600 rounded-md p-2 text-center">
      </div>
    </div>

    <!-- Photons per Frame -->
    <div>
      <label for="photonsPerFrame" class="block text-sm font-medium text-gray-300">Avg. Signal Photons / Frame</label>
      <div class="flex items-center gap-4 mt-1">
        <input type="range" id="photonsPerFrame" min="1" max="100" step="1" [value]="params().photonsPerFrame" (input)="updateParam('photonsPerFrame', $any($event.target).valueAsNumber)" [disabled]="isDisabled()"
               class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-cyan-500">
        <input type="number" [value]="params().photonsPerFrame" (input)="updateParam('photonsPerFrame', $any($event.target).valueAsNumber)" [disabled]="isDisabled()"
               class="w-24 bg-gray-800 border border-gray-600 rounded-md p-2 text-center">
      </div>
    </div>

    <!-- Noise Ratio -->
    <div>
      <label for="noiseRatio" class="block text-sm font-medium text-gray-300">Noise Ratio (Noise/Signal)</label>
      <div class="flex items-center gap-4 mt-1">
        <input type="range" id="noiseRatio" min="0" max="10" step="0.1" [value]="params().noiseRatio" (input)="updateParam('noiseRatio', $any($event.target).valueAsNumber)" [disabled]="isDisabled()"
               class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-cyan-500">
        <input type="number" [value]="params().noiseRatio" (input)="updateParam('noiseRatio', $any($event.target).valueAsNumber)" [disabled]="isDisabled()"
               class="w-24 bg-gray-800 border border-gray-600 rounded-md p-2 text-center">
      </div>
    </div>

    <!-- Short-Term Frames -->
    <div>
      <label for="shortTermFrames" class="block text-sm font-medium text-gray-300">Short-Term Integration Frames</label>
      <div class="flex items-center gap-4 mt-1">
        <input type="range" id="shortTermFrames" min="1" max="5000" step="10" [value]="params().shortTermFrames" (input)="updateParam('shortTermFrames', $any($event.target).valueAsNumber)" [disabled]="isDisabled()"
               class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-cyan-500">
        <input type="number" [value]="params().shortTermFrames" (input)="updateParam('shortTermFrames', $any($event.target).valueAsNumber)" [disabled]="isDisabled()"
               class="w-24 bg-gray-800 border border-gray-600 rounded-md p-2 text-center">
      </div>
    </div>

    <!-- Memory Estimation -->
    <div class="mt-6 p-3 rounded-lg border transition-colors duration-300" 
         [class.bg-gray-800]="!isMemoryExceeded()" 
         [class.border-gray-700]="!isMemoryExceeded()" 
         [class.bg-red-900/50]="isMemoryExceeded()" 
         [class.border-red-600]="isMemoryExceeded()">
      <div class="flex items-center justify-between">
        <span class="text-sm font-medium text-gray-300">Estimated File Size</span>
        <span class="font-bold text-lg" 
              [class.text-white]="!isMemoryExceeded()" 
              [class.text-red-300]="isMemoryExceeded()">
          {{ estimatedMemoryMB().toFixed(2) }} MB
        </span>
      </div>
      @if (isMemoryExceeded()) {
        <p class="text-sm text-red-300 mt-2 text-center">
          <span class="font-bold">Warning:</span> Parameters exceed the 1GB memory limit and will likely crash the browser. Please reduce Frames or Resolution.
        </p>
      }
    </div>


    <!-- Generate Button -->
    <button (click)="emitGenerate()" [disabled]="isDisabled()"
            class="w-full bg-cyan-600 hover:bg-cyan-500 disabled:bg-gray-600 disabled:cursor-not-allowed text-white font-bold py-3 px-4 rounded-lg transition duration-300 ease-in-out flex items-center justify-center gap-2">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
      Generate Data
    </button>
  </div>
</div>